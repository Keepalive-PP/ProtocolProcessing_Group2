<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>BGP Simulator: BGP Simulator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">BGP Simulator
   &#160;<span id="projectnumber">Programming Group 2, Protocol Processing 2013, University of Turku</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BGP Simulator </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd><ul>
<li>Antti Siirilä, 501449, <a href="#" onclick="location.href='mai'+'lto:'+'anj'+'os'+'i@u'+'tu'+'.fi'; return false;">anjos<span style="display: none;">.nosp@m.</span>i@ut<span style="display: none;">.nosp@m.</span>u.fi</a></li>
<li>Heikki Juva, 76718, <a href="#" onclick="location.href='mai'+'lto:'+'juv'+'a.'+'hj@'+'gm'+'ail'+'.c'+'om'; return false;">juva.<span style="display: none;">.nosp@m.</span>hj@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a></li>
<li>Iiro Räsänen, 78366, <a href="#" onclick="location.href='mai'+'lto:'+'imr'+'as'+'a@u'+'tu'+'.fi'; return false;">imras<span style="display: none;">.nosp@m.</span>a@ut<span style="display: none;">.nosp@m.</span>u.fi</a> </li>
</ul>
</dd></dl>
<dl class="section date"><dt>Date</dt><dd>29.5.2013 </dd></dl>
<h1><a class="anchor" id="s_intro"></a>
Introduction</h1>
<p>BGP is a vital part of the Internet providing routing services between autonomous system. The goal of this projecs was to get familiar with the BGP protocol through a programming project. The programming projects contained the design and implementation of a BGP simulator. The design contains two main components the <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> and the User <a class="el" href="classInterface.html" title="Interface module inside a Router module.">Interface</a> (<a class="el" href="namespaceUI.html">UI</a>). The implementation of the <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> bases on SystemC where as the <a class="el" href="namespaceUI.html">UI</a> was implemeted with Python. </p>
<h1><a class="anchor" id="s_design"></a>
Design</h1>
<p>The architecture of the BGP simulator has devided in two modules: User <a class="el" href="classInterface.html" title="Interface module inside a Router module.">Interface</a> (<a class="el" href="namespaceUI.html">UI</a>) implemented with Python, and <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> implemented with the SystemC. The figure 1 illustrates the modules and their interconnection. </p>
<div class="image">
<img src="Top.png" alt="Top.png"/>
<div class="caption">
Figure 1. The top level of the BGP simulator</div></div>
<p> The <a class="el" href="namespaceUI.html">UI</a> allows the user to setup the simulation environment including the number of routers, the network topology, and the router configurations. Once the simulation configuration is setup, it is sent to the sc_main through the TCP socket. The sc_main is responsiple on building the simulation environment according to the configuration data received from the <a class="el" href="namespaceUI.html">UI</a>. Once the sc_main has elaborated the <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a>, it passes the TCP socket handle to the <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> and start the SystemC kernel. From there on the BGP simulation stars and the <a class="el" href="namespaceUI.html">UI</a> is able to receive simulation status over the TCP link by using a defined set of commands (<a class="el" href="GUIProtocolTags_8hpp.html" title="Contains all the defines of the Simulation.">GUIProtocolTags.hpp</a>). </p>
<h2><a class="anchor" id="sub_Simulation"></a>
Simulation</h2>
<p>The simulation module (figure 2) comprises of network nodes and their interconnection. Each network node contains the <a class="el" href="classRouter.html" title="Router module.">Router</a> and <a class="el" href="classHost.html" title="Host module.">Host</a> modules. The host module represents the local AS and can be used to send and receive IP packets to/from other ASes. </p>
<div class="image">
<img src="Simulation_diagram.png" alt="Simulation_diagram.png"/>
<div class="caption">
Figure 2. The router modules inside the Simulation module</div></div>
<p> The figure 3 defines the submodules and their relations inside the router module. The main modules are Data and Control planes, Routing table, and network Interfaces. </p>
<div class="image">
<img src="Module_diagram.png" alt="Module_diagram.png"/>
<div class="caption">
Figure 3. The submodules of the Router module</div></div>
<p> The number of network interfaces of the <a class="el" href="classRouter.html" title="Router module.">Router</a> is defined to four. Three of the interfaces are dedicated for BGP peer connections and the remaining one connects to the host module. Each <a class="el" href="classInterface.html" title="Interface module inside a Router module.">Interface</a> has receiving and forwarding buffers. The <a class="el" href="classDataPlane.html" title="Protocol Engine module.">DataPlane</a> (DP) module handles the IP packet and BGP message forwarding. It connects to the receiving and forwarding buffers of all interfaces. In addition the DP connect to the <a class="el" href="classRoutingTable.html" title="RoutingTable module.">RoutingTable</a> (RT), which allows it to resolve routes for IP packets. Furhtermore, the DP passes all the BGP message to the <a class="el" href="classControlPlane.html" title="ControlPlane module runs the BGP process.">ControlPlane</a> (CP) module and provides an interface for BGP message forwarding. IP packets are processed on bitlevel by <a class="el" href="classPacketProcessor.html" title="PacketProcessor class.">PacketProcessor</a> submodule. The forwarding function includes the IP packet validation, destination resolving, TTL decrementation, and checksum recalculation processes. The CP has three BGP sessions for each BGP adjacent interface as submodules. <a class="el" href="classControlPlane.html" title="ControlPlane module runs the BGP process.">ControlPlane</a> simply distributes the received BGP messages to the correct bGP session. The <a class="el" href="classBGPSession.html" title="BGPSession module handles the HoldDown and Keepalive timers of the session and sends keepalive messag...">BGPSession</a> module controls the BGP session states and timers. Once the peer interface of BGP session comes up, the session tries to establish a connection with the adjacent BGP router. The connection states follows the BGP specification (<a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol">https://en.wikipedia.org/wiki/Border_Gateway_Protocol</a>). Once the connection is successfully established including the BGP OPEN message exchange, the BGP session transitions to the ESTABLISHED state. In ESTABLISHED state the BGP session simply sends keepalives, if required, and forwards BGP UPDATE messages to the <a class="el" href="classRoutingTable.html" title="RoutingTable module.">RoutingTable</a> (RT). Whenever the hold-down timer expires or a NOTIFICATION message is received, the <a class="el" href="classBGPSession.html" title="BGPSession module handles the HoldDown and Keepalive timers of the session and sends keepalive messag...">BGPSession</a> invalidates and transition to the IDLE state. The <a class="el" href="classRoutingTable.html" title="RoutingTable module.">RoutingTable</a> module builds the BGP routing table based on the local AS information and the received BGP UPDATE messages. RT listens the <a class="el" href="classBGPSession.html" title="BGPSession module handles the HoldDown and Keepalive timers of the session and sends keepalive messag...">BGPSession</a> states and updates the routing table and generates required UPDATE messages in case of change in state. In addition, RT reads the UPDATE messages from the input buffer and does the required table updates according to BGP specification and local policies. </p>
<h2><a class="anchor" id="sub_UI"></a>
User Interface</h2>
<p><a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> is based on Python 2.7 and PyGame-library, that handles the graphics. PyGame is extended with our UI-library, that is derived from another project, called Xadir, that needed simple UI-components such as buttons and panels. The UI-library was also co-authored by Heikki Juva, and expanded during this project with needed classes. <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> uses also SelectDialog-class by Aleksi Torhamo, also originally created for Xadir-project. The EzText-library by Anonymous author is found in <a href="http://www.pygame.org/project-EzText-920-.html">http://www.pygame.org/project-EzText-920-.html</a>. This library is used for text-input, and extended for better support of selection one textfield and input-characters.</p>
<p>The <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> UI-library defines two types of classes, UI- and Data-classes. UI-class defines strictly UI-related class, for example the RouterModel-class that is used to represent selected router and displays information about the given router. Data-classes are defined in <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> to represent the objects in SystemC-simulation. This makes it simple to create simulation objects, such as Routers, Interfaces and so on in <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> before the SystemC-simulation is started. After the SystemC simulation is started, <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> objects are periodically synced using the socket-connection. Good example of this is the routing tables, that are read from router in SystemC simulation and given for corresponding <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> router. Then the selectdialogs in <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> <a class="el" href="namespaceUI.html">UI</a> read the tables from objects defined in Python.</p>
<p>Because the simulation has to be widely configurable and at the same time user need information about all of the aspects of simulation, such as routers, packets, network and routing tables, we decided to use console-type input system to setup the simulation and control simulation when running. Most of the advanced configs about routers and connections are available from console, such as setting router prefix. More simple things, such as creating routers and connecting routers together can be done with mouse. You can check available console commands by typing command "help" inside console.</p>
<p>When user has defined the desired simulation options, simulation can be started by clicking "Start". This sends the configuration to SystemC-simulation by socket-connection and starts updating the routing tables. Now user can send packets between routers, disable connections from console and follow the structure of routing tables when modifying the network topology. </p>
<h1><a class="anchor" id="s_HowTo"></a>
How To</h1>
<h2><a class="anchor" id="sub_Prep"></a>
Preparations</h2>
<ol type="1">
<li>systemC 2.3.0 library installed for <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a></li>
<li>python and pygame for <a class="el" href="namespaceUI.html">UI</a></li>
</ol>
<h2><a class="anchor" id="sub_Compile"></a>
Compilation</h2>
<ol type="1">
<li>Define a name for your executable (EXE), your systemC path (SYSTEMC) and your architecture (T_ARCH) in the makefile, and save.</li>
<li>Make</li>
</ol>
<h2><a class="anchor" id="sub_Run"></a>
Execute</h2>
<ol type="1">
<li>Start the <a class="el" href="classSimulation.html" title="Simulation top module.">Simulation</a> first by running the executable</li>
<li>Navigate to the <a class="el" href="namespaceUI.html">UI</a> folder and run "python SimulationUI.py"</li>
<li>Add and configure the routers</li>
<li>Connect the routers</li>
<li>click start to launch the simulation</li>
<li>type help to see the router commands and their options</li>
</ol>
<h1><a class="anchor" id="s_conclusion"></a>
Conclusion</h1>
<p>In this programming exercise, a BGP network simulator was designed, and implemented using Python and SystemC. The BGP cold start and table update processes were successfully simulated for start topologies. The IP packet processesing was implemented on bitlevel as specified in RFC 1812. The IP packet routing was also simulated by sending test packets between ASes. </p>
<h2><a class="anchor" id="sub_futureImprovements"></a>
Future Improvements</h2>
<p>Some of the basic functionality such as withdrawing a route and avoiding routing loops was not successfully simulated due to some bugs in the RT module. The simulation of the previously mentioned functions of BGP would require a thorough debugging of RT and perhaps a redesign of some of its components. In addition, implementing some experimental BGP functionalites such as security improvments would be interesting to simulate in the future. </p>
<h2><a class="anchor" id="sub_whatwelearned"></a>
What We Learned</h2>
<p>The goal of this project was to study BGP-protocol and its functions as an inter domain routing protocol of the Internet. The method was to build software that simulates those BGP functions. We spent several weeks for researching BPG-protocol standards and identifying the required aspects for building a working BGP-simulator. As an outcome of the researching process, we gained a strong knowledge of network protocols in general, as well as how those different protocols intervene in currently used BGP-networks. In addition, we adopted a strong knowledge on router architectures and configurations, and in IP-packet processing on the network layer (bit level processing). The information extracted during the research phase was put directly into the use in the BGP-simulator's design phase. We had to define the datatypes, classes and logic to store, transfer, and process all the data on BGP-simulator. Furthermore, we had to build a working and usable user interface for users to configure and control the simulation.</p>
<p>All in all, this project provided a perfect way to get at the deep end of BGP-protocol and Internet routing on BGP-level. Although it took relatively long time to get the simulation software finished and running, we think that there is no better way to gain as strong practical knowledge on the network protocols and protocol processing as we have been able to do during this project. This extremely interesting project has been an outstanding learning experience and will for sure give us strength and motivation for our future projects. We also have a strong will to continue the development of the BGP-simulator in the direction mentioned in the previous chapter. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 29 2013 21:03:45 for BGP Simulator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
